{% extends "base.html" %}

{% block title %}Admin Dashboard - {{ session.admin_restaurant_name }}{% endblock %}

{% block content %}
<div class="admin-header">
    <div class="container">
        <h1 class="admin-title">üè™ {{ session.admin_restaurant_name }} - Admin Dashboard</h1>
    </div>
</div>

<div class="dashboard-stats">
    <div class="stat-card">
        <div class="stat-number">{{ bookings|length }}</div>
        <div class="stat-label">Total Bookings</div>
    </div>
    
    <div class="stat-card">
        <div class="stat-number">{{ special_offers|length }}</div>
        <div class="stat-label">Active Offers</div>
    </div>
    
    <div class="stat-card">
        <div class="stat-number">
            {% set today_bookings = bookings|selectattr('booking_date', 'equalto', today)|list %}
            {{ today_bookings|length }}
        </div>
        <div class="stat-label">Today's Bookings</div>
    </div>
</div>

<div class="grid grid-2">
    <div class="card">
        <h3 class="card-title">üìã Recent Bookings</h3>
        
        {% if bookings %}
        <div class="booking-table">
            <table>
                <thead>
                    <tr>
                        <th>Customer</th>
                        <th>Table</th>
                        <th>Date</th>
                        <th>Time</th>
                        <th>Party Size</th>
                        <th>Status</th>
                    </tr>
                </thead>
                <tbody>
                    {% for booking in bookings[:10] %}
                    <tr>
                        <td>{{ booking.username }}</td>
                        <td>{{ booking.table_number }}</td>
                        <td>{{ booking.booking_date }}</td>
                        <td>{{ booking.booking_time }}</td>
                        <td>{{ booking.party_size }}</td>
                        <td>
                            <span class="btn btn-success" style="padding: 0.25rem 0.5rem; font-size: 0.8rem;">
                                {{ booking.status|title }}
                            </span>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        {% else %}
        <div class="text-center">
            <p>No bookings yet.</p>
        </div>
        {% endif %}
    </div>
    
    <div class="card">
        <h3 class="card-title">üéâ Special Offers</h3>
        
        <a href="{{ url_for('admin_add_offer') }}" class="btn btn-primary mb-3">
            <i class="fas fa-plus"></i> Add New Offer
        </a>
        
        {% if special_offers %}
            {% for offer in special_offers[:5] %}
            <div class="offer-card">
                <div class="offer-title">{{ offer.title }}</div>
                <div class="offer-description">{{ offer.description }}</div>
                <div class="offer-discount">{{ offer.discount_percentage }}% OFF</div>
                <small>Valid: {{ offer.valid_from }} to {{ offer.valid_to }}</small>
            </div>
            {% endfor %}
        {% else %}
        <div class="text-center">
            <p>No special offers created yet.</p>
        </div>
        {% endif %}
    </div>
</div>

<div class="card">
    <h3 class="card-title">üìä Quick Actions</h3>
    
    <div class="grid grid-3">
        <div class="card">
            <div class="text-center">
                <i class="fas fa-calendar-plus" style="font-size: 2rem; color: #667eea; margin-bottom: 1rem;"></i>
                <h4>View All Bookings</h4>
                <p>See all customer bookings for your restaurant</p>
            </div>
        </div>
        
        <div class="card">
            <div class="text-center">
                <i class="fas fa-gift" style="font-size: 2rem; color: #ffc107; margin-bottom: 1rem;"></i>
                <h4>Manage Offers</h4>
                <p>Create and manage special offers for customers</p>
                <a href="{{ url_for('admin_add_offer') }}" class="btn btn-warning btn-full">
                    <i class="fas fa-plus"></i> Add Offer
                </a>
            </div>
        </div>
        
        <div class="card">
            <div class="text-center">
                <i class="fas fa-chart-bar" style="font-size: 2rem; color: #28a745; margin-bottom: 1rem;"></i>
                <h4>Restaurant Stats</h4>
                <p>View performance metrics and customer feedback</p>
            </div>
        </div>
    </div>
</div>
{% endblock %}
